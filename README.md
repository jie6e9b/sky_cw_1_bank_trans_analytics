# Учебный проект на Python

Этот репозиторий содержит набор модулей для анализа и отображения финансовых транзакций. Модули реализуют функциональность фильтрации, агрегации, визуализации и получения данных из внешних источников.

---

## ▎Модули

### ▎1. `reports.py` — Генерация отчетов и визуализаций

Модуль предназначен для построения графиков и PDF-отчетов на основе транзакционных данных.

**Основные функции:**
- `generate_expenses_by_category_chart(df)` — создает диаграмму расходов по категориям.
- `generate_daily_expense_trend_chart(df)` — строит тренд ежедневных расходов.
- `generate_pdf_report(df, start_date, end_date, file_path)` — формирует PDF-отчет с графиками и сводной таблицей.

▎Особенности:
- Используются библиотеки `matplotlib` и `reportlab`
- Поддержка генерации диаграмм даже при частично пустых данных

---

### ▎2. `services.py` — Аггрегация и обработка данных

Отвечает за обобщение и расчет ключевых метрик по транзакциям.

**Основные функции:**
- `aggregate_by_category(df)` — группирует расходы по категориям.
- `aggregate_by_day(df)` — группирует суммы по дням.
- `summarize_by_card(df)` — рассчитывает общие суммы и кэшбэк по картам.

▎Особенности:
- Обработка пустых и частично заполненных данных
- Форматы данных пригодны для визуализации и отчетности

---

### ▎3. `utils.py` — Утилиты и вспомогательные функции

Содержит функции для загрузки данных, фильтрации по датам и обращения к внешним API.

**Основные функции:**
- `read_data_file()` — загрузка и предобработка Excel-файла с транзакциями.
- `get_date_range(date_time_str)` — определяет диапазон дат для анализа.
- `get_slice_of_data(start, end)` — фильтрует транзакции по диапазону дат.
- `get_summary_card_data(df)` — вычисляет суммы и кэшбэк по картам.
- `top_5_transactions_by_sum(df)` — находит топ-5 транзакций по сумме.
- `actual_currencies()` — получает текущие курсы валют (через API).
- `actual_stocks()` — получает текущие цены акций (через API).
- `get_time_for_greeting()` — возвращает приветствие в зависимости от времени суток.

▎Особенности:
- Поддержка мока API для офлайн-тестирования
- Маскирование номеров карт

---

### ▎4. `views.py` — Сборка итоговых данных для интерфейса

Модуль формирует финальный JSON-объект для отображения на главной странице.

**Основная функция:**
- `main_info(date_time)` — собирает приветствие, карточки, транзакции, курсы валют и акций в один JSON по заданной дате.

▎Особенности:
- Встроенный логгер
- Обработка ошибок формата даты
- Стандартизированный JSON-вывод для UI

---

## ▎Тестирование

Проект покрыт модульными тестами, реализованными с использованием `pytest`.

**Покрываемые аспекты:**
- `utils.py` — загрузка, фильтрация, API-запросы, расчеты по картам и транзакциям
- `services.py` — агрегация по категориям, дням, картам
- `reports.py` — генерация диаграмм и PDF
- `views.py` — итоговый JSON-ответ и обработка ошибок

**Запуск тестов:**
```bash
pytest tests/


